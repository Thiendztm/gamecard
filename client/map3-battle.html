<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Map 3 - Battle</title>
    <link rel="stylesheet" href="css/audio.css">
    <link rel="stylesheet" href="css/character-sprites.css">
    <script src="/socket.io/socket.io.js"></script>
    <script src="character-functions.js" defer></script>
    <script src="music-manager.js" defer></script>
    <script src="memory-optimization.js" defer></script>
    <script src="skills-system.js" defer></script>
    <script src="skill-manager.js" defer></script>
    <script src="sfx-manager.js" defer></script>
    <script src="combatSystem.js" defer></script>
</head>
<body style="background-image: url('/DesignHud/map3.png');background-repeat: no-repeat; background-size: cover; background-position: center; height: 100vh; width: 100vw; margin: 0; padding: 0;">
    <div class="music-control">
        <div class="music-icon" id="musicIcon">üéµ</div>
        <div class="volume-control">
            <span class="volume-text" id="volumeText">50%</span>
            <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="50">
        </div>
    </div>
    
    <div class="action-panel">
        <div class="action-items">
            <div class="action-item">ƒê√°nh</div>
            <div class="action-item">K·ªπ nƒÉng</div>
            <div class="action-item">Ph√≤ng th·ªß</div>
        </div>
        <div class="user-section"></div>
    </div>
    
    <audio id="backgroundMusic" loop preload="none">
        <source src="/audio/12. The Young Descendant of Tepes.mp3" type="audio/mpeg">
    </audio>
    
    <script>
        // Socket connection for AI battle mode
        const socket = io();
        
        // Set up AI battle mode
        window.isAIBattle = true;
        
        // Set up room and player IDs for AI combat system
        window.currentRoomId = sessionStorage.getItem('currentRoomId');
        window.currentPlayerId = sessionStorage.getItem('currentPlayerId');
        
        // Get AI battle data
        const gameData = JSON.parse(sessionStorage.getItem('gameData') || '{}');
        if (gameData.roomId) {
            window.currentRoomId = gameData.roomId;
            sessionStorage.setItem('currentRoomId', gameData.roomId);
        }
        if (gameData.players && gameData.players.length > 0) {
            const user = JSON.parse(sessionStorage.getItem('user') || '{}');
            window.currentPlayerId = user.username;
            sessionStorage.setItem('currentPlayerId', user.username);
        }
        
        console.log('AI Battle Map 3 initialized with:', {
            roomId: window.currentRoomId,
            playerId: window.currentPlayerId,
            gameData: sessionStorage.getItem('gameData'),
            user: sessionStorage.getItem('user'),
            isAIBattle: true
        });
        
        // Make socket available globally
        window.socket = socket;
        
    </script>
</body>
</html>
